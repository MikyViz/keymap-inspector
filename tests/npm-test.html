<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–¢–µ—Å—Ç NPM –≤–µ—Ä—Å–∏–∏</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; background: #f5f5f5; }
        .container { background: white; padding: 20px; border-radius: 8px; margin: 10px 0; }
        .success { color: #28a745; background: #d4edda; padding: 10px; border-radius: 4px; }
        .error { color: #dc3545; background: #f8d7da; padding: 10px; border-radius: 4px; }
        .info { color: #0c5460; background: #d1ecf1; padding: 10px; border-radius: 4px; }
        pre { background: #f8f9fa; padding: 10px; border-radius: 4px; overflow-x: auto; }
        .test-result { margin: 10px 0; padding: 10px; border-left: 4px solid #007bff; background: #f8f9fa; }
    </style>
</head>
<body>
    <h1>üß™ –¢–µ—Å—Ç keymap-inspector –∏–∑ NPM</h1>
    
    <div class="container">
        <h2>1. –ó–∞–≥—Ä—É–∑–∫–∞ –∏–∑ unpkg (browser.js)</h2>
        <div id="browserTest"></div>
    </div>
    
    <div class="container">
        <h2>2. –ó–∞–≥—Ä—É–∑–∫–∞ –∏–∑ unpkg (umd.js)</h2>
        <div id="umdTest"></div>
    </div>
    
    <div class="container">
        <h2>3. –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –≤–µ—Ä—Å–∏–π</h2>
        <div id="comparisonTest"></div>
    </div>

    <!-- –¢–µ—Å—Ç 1: browser.js –≤–µ—Ä—Å–∏—è –∏–∑ npm -->
    <script src="https://unpkg.com/keymap-inspector@latest/dist/keymap-inspector.browser.js"></script>
    
    <script>
        // –°–æ—Ö—Ä–∞–Ω—è–µ–º browser.js –≤–µ—Ä—Å–∏—é
        window.BrowserKeymap = window.KeymapInspector || KeymapInspector;
        
        function testBrowserJS() {
            const div = document.getElementById('browserTest');
            let html = '';
            
            html += `<div class="info"><strong>–í–µ—Ä—Å–∏—è:</strong> keymap-inspector@latest/browser.js</div>`;
            html += `<div class="test-result"><strong>–¢–∏–ø:</strong> ${typeof BrowserKeymap}</div>`;
            
            if (typeof BrowserKeymap === 'function') {
                html += `<div class="test-result"><strong>–°–≤–æ–π—Å—Ç–≤–∞:</strong> ${Object.getOwnPropertyNames(BrowserKeymap).join(', ')}</div>`;
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ä–∞—Å–∫–ª–∞–¥–∫–∏
                const layouts = ['en', 'ru', 'de', 'fr', 'es', 'ua', 'he'];
                layouts.forEach(layout => {
                    const exists = BrowserKeymap[layout] !== undefined;
                    const count = exists ? Object.keys(BrowserKeymap[layout] || {}).length : 0;
                    html += `<div class="${exists ? 'success' : 'error'}">
                        ${exists ? '‚úÖ' : '‚ùå'} ${layout.toUpperCase()}: ${exists ? `${count} —Å–∏–º–≤–æ–ª–æ–≤` : 'undefined'}
                    </div>`;
                });
                
                // –ü–æ–ø—ã—Ç–∫–∞ —Å–æ–∑–¥–∞—Ç—å inspector
                try {
                    const inspector = new BrowserKeymap({
                        en: BrowserKeymap.en,
                        ru: BrowserKeymap.ru
                    });
                    
                    const testResult = inspector.inspect('a');
                    if (testResult) {
                        html += `<div class="success">‚úÖ Inspector —Ä–∞–±–æ—Ç–∞–µ—Ç! –¢–µ—Å—Ç 'a': ${testResult.keyDefinition.code}</div>`;
                        window.workingInspector = inspector;
                    } else {
                        html += `<div class="error">‚ùå Inspector —Å–æ–∑–¥–∞–ª—Å—è, –Ω–æ inspect('a') –≤–µ—Ä–Ω—É–ª null</div>`;
                    }
                } catch (error) {
                    html += `<div class="error">‚ùå –û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è inspector: ${error.message}</div>`;
                }
            }
            
            div.innerHTML = html;
        }
        
        testBrowserJS();
        
        // –õ–æ–≥–∏ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏ (–∫–∞–∫ –≤ –≤–∞—à–µ–º —Ñ–∞–π–ª–µ)
        console.log('üîç KeymapInspector object:', BrowserKeymap);
        console.log('üîç KeymapInspector properties:', Object.keys(BrowserKeymap));
        console.log('üîç KeymapInspector type:', typeof BrowserKeymap);
        console.log('üîç KeymapInspector.en:', BrowserKeymap.en);
        console.log('üîç KeymapInspector.ru:', BrowserKeymap.ru);
    </script>
    
    <!-- –¢–µ—Å—Ç 2: UMD –≤–µ—Ä—Å–∏—è -->
    <script>
        // –û—á–∏—â–∞–µ–º –≥–ª–æ–±–∞–ª—å–Ω–æ–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ
        window.KeymapInspector = undefined;
        delete window.KeymapInspector;
    </script>
    <script src="https://unpkg.com/keymap-inspector@latest/dist/keymap-inspector.umd.js"></script>
    
    <script>
        function testUMD() {
            const div = document.getElementById('umdTest');
            let html = '';
            
            html += `<div class="info"><strong>–í–µ—Ä—Å–∏—è:</strong> keymap-inspector@latest/umd.js</div>`;
            html += `<div class="test-result"><strong>–¢–∏–ø:</strong> ${typeof KeymapInspector}</div>`;
            
            if (typeof KeymapInspector === 'object') {
                html += `<div class="test-result"><strong>–°–≤–æ–π—Å—Ç–≤–∞:</strong> ${Object.keys(KeymapInspector).join(', ')}</div>`;
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ä–∞—Å–∫–ª–∞–¥–∫–∏
                const layouts = ['en', 'ru', 'de', 'fr', 'es', 'ua', 'he', 'KeymapInspector'];
                layouts.forEach(layout => {
                    const exists = KeymapInspector[layout] !== undefined;
                    let count = 0;
                    if (exists && layout !== 'KeymapInspector') {
                        count = Object.keys(KeymapInspector[layout] || {}).length;
                    }
                    html += `<div class="${exists ? 'success' : 'error'}">
                        ${exists ? '‚úÖ' : '‚ùå'} ${layout}: ${exists ? 
                            (layout === 'KeymapInspector' ? 'constructor' : `${count} —Å–∏–º–≤–æ–ª–æ–≤`) : 'undefined'}
                    </div>`;
                });
                
                // –ü–æ–ø—ã—Ç–∫–∞ —Å–æ–∑–¥–∞—Ç—å inspector
                try {
                    let inspector;
                    if (KeymapInspector.KeymapInspector) {
                        inspector = new KeymapInspector.KeymapInspector({
                            en: KeymapInspector.en,
                            ru: KeymapInspector.ru
                        });
                    }
                    
                    if (inspector) {
                        const testResult = inspector.inspect('a');
                        if (testResult) {
                            html += `<div class="success">‚úÖ UMD Inspector —Ä–∞–±–æ—Ç–∞–µ—Ç! –¢–µ—Å—Ç 'a': ${testResult.keyDefinition.code}</div>`;
                        } else {
                            html += `<div class="error">‚ùå UMD Inspector —Å–æ–∑–¥–∞–ª—Å—è, –Ω–æ inspect('a') –≤–µ—Ä–Ω—É–ª null</div>`;
                        }
                    } else {
                        html += `<div class="error">‚ùå –ù–µ —É–¥–∞–ª–æ—Å—å —Å–æ–∑–¥–∞—Ç—å UMD inspector</div>`;
                    }
                } catch (error) {
                    html += `<div class="error">‚ùå –û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è UMD inspector: ${error.message}</div>`;
                }
            }
            
            div.innerHTML = html;
        }
        
        // –î–∞—ë–º –≤—Ä–µ–º—è UMD –∑–∞–≥—Ä—É–∑–∏—Ç—å—Å—è
        setTimeout(testUMD, 100);
    </script>
    
    <script>
        function compareVersions() {
            const div = document.getElementById('comparisonTest');
            let html = '<h3>–†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å—Ä–∞–≤–Ω–µ–Ω–∏—è:</h3>';
            
            if (window.workingInspector) {
                html += '<div class="success">‚úÖ –†–∞–±–æ—á–∏–π inspector –Ω–∞–π–¥–µ–Ω –≤ browser.js –≤–µ—Ä—Å–∏–∏</div>';
                html += '<div class="info">üí° –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è: –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ browser.js –¥–ª—è –≤–∞—à–µ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞</div>';
                
                // –ü—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ–º —Ä–∞–±–æ—á–∏–π –∫–æ–¥
                html += `<h4>–†–∞–±–æ—á–∏–π –∫–æ–¥ –¥–ª—è –≤–∞—à–µ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞:</h4>`;
                html += `<pre>
&lt;script src="https://unpkg.com/keymap-inspector@latest/dist/keymap-inspector.browser.js"&gt;&lt;/script&gt;
&lt;script&gt;
    // –ü—Ä–æ–≤–µ—Ä—è–µ–º —á—Ç–æ —Ä–∞—Å–∫–ª–∞–¥–∫–∏ –¥–æ—Å—Ç—É–ø–Ω—ã
    if (KeymapInspector.en && KeymapInspector.ru) {
        const inspector = new KeymapInspector({
            en: KeymapInspector.en,
            ru: KeymapInspector.ru,
            de: KeymapInspector.de,
            fr: KeymapInspector.fr,
            es: KeymapInspector.es,
            ua: KeymapInspector.ua,
            he: KeymapInspector.he
        });
        
        window.globalInspector = inspector;
        console.log('‚úÖ –ò–Ω—Å–ø–µ–∫—Ç–æ—Ä –≥–æ—Ç–æ–≤!');
    } else {
        console.error('‚ùå –†–∞—Å–∫–ª–∞–¥–∫–∏ –Ω–µ –∑–∞–≥—Ä—É–∑–∏–ª–∏—Å—å');
    }
&lt;/script&gt;
</pre>`;
            } else {
                html += '<div class="error">‚ùå –ù–∏ –æ–¥–Ω–∞ –≤–µ—Ä—Å–∏—è –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ</div>';
                html += '<div class="info">üí° –ù—É–∂–Ω–æ –∏—Å–ø—Ä–∞–≤–∏—Ç—å npm –ø–∞–∫–µ—Ç</div>';
            }
            
            div.innerHTML = html;
        }
        
        setTimeout(compareVersions, 500);
    </script>
</body>
</html>

