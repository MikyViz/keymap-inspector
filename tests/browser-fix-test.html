<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–¢–µ—Å—Ç Keymap Inspector Browser Fix</title>
    <style>
        body { 
            font-family: Arial, sans-serif; 
            margin: 50px; 
            background: #f5f5f5; 
        }
        .test-section { 
            background: white; 
            padding: 20px; 
            margin: 20px 0; 
            border-radius: 8px; 
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        .success { color: #28a745; font-weight: bold; }
        .error { color: #dc3545; font-weight: bold; }
        .info { color: #17a2b8; }
        pre { background: #f8f9fa; padding: 10px; border-radius: 4px; overflow-x: auto; }
        input { padding: 10px; font-size: 16px; border: 2px solid #ddd; border-radius: 4px; }
        .result { background: #e8f5e8; padding: 10px; margin: 10px 0; border-radius: 4px; }
    </style>
</head>
<body>
    <h1>üîß –¢–µ—Å—Ç –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π Browser JS</h1>
    
    <div class="test-section">
        <h2>1. –¢–µ—Å—Ç –∑–∞–≥—Ä—É–∑–∫–∏ –∏–∑ dist/keymap-inspector.browser.js</h2>
        <div id="browserTest"></div>
    </div>
    
    <div class="test-section">
        <h2>2. –¢–µ—Å—Ç –∑–∞–≥—Ä—É–∑–∫–∏ –∏–∑ dist/keymap-inspector.umd.js</h2>
        <div id="umdTest"></div>
    </div>
    
    <div class="test-section">
        <h2>3. –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π —Ç–µ—Å—Ç</h2>
        <input type="text" id="testChar" placeholder="–í–≤–µ–¥–∏—Ç–µ —Å–∏–º–≤–æ–ª..." maxlength="1">
        <div id="testResult"></div>
    </div>

    <!-- –°–Ω–∞—á–∞–ª–∞ —Ç–µ—Å—Ç–∏—Ä—É–µ–º browser.js -->
    <script src="../dist/keymap-inspector.browser.js"></script>
    
    <script>
        // –¢–µ—Å—Ç browser.js
        function testBrowserJS() {
            const testDiv = document.getElementById('browserTest');
            let html = '';
            
            html += `<h3>KeymapInspector –∑–∞–≥—Ä—É–∂–µ–Ω:</h3>`;
            html += `<pre>–¢–∏–ø: ${typeof KeymapInspector}</pre>`;
            html += `<pre>–°–≤–æ–π—Å—Ç–≤–∞: ${Object.getOwnPropertyNames(KeymapInspector)}</pre>`;
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ä–∞—Å–∫–ª–∞–¥–∫–∏
            const layouts = ['en', 'ru', 'de', 'fr', 'es', 'ua', 'he'];
            layouts.forEach(layout => {
                const available = KeymapInspector[layout] ? '‚úÖ' : '‚ùå';
                const count = KeymapInspector[layout] ? Object.keys(KeymapInspector[layout]).length : 0;
                html += `<div class="${KeymapInspector[layout] ? 'success' : 'error'}">
                    ${available} ${layout.toUpperCase()}: ${count} —Å–∏–º–≤–æ–ª–æ–≤
                </div>`;
            });
            
            // –ü—Ä–æ–±—É–µ–º —Å–æ–∑–¥–∞—Ç—å inspector
            try {
                const inspector = new KeymapInspector({
                    en: KeymapInspector.en,
                    ru: KeymapInspector.ru,
                    de: KeymapInspector.de,
                    fr: KeymapInspector.fr,
                    es: KeymapInspector.es,
                    ua: KeymapInspector.ua,
                    he: KeymapInspector.he
                });
                
                html += `<div class="success">‚úÖ Inspector —Å–æ–∑–¥–∞–Ω —É—Å–ø–µ—à–Ω–æ!</div>`;
                window.browserInspector = inspector;
                
                // –¢–µ—Å—Ç–∏—Ä—É–µ–º —Å–∏–º–≤–æ–ª—ã
                const testChars = ['a', '–π', '√§', '√©'];
                testChars.forEach(char => {
                    const result = inspector.inspect(char);
                    if (result) {
                        html += `<div class="info">‚úÖ '${char}' ‚Üí ${result.keyDefinition.code}</div>`;
                    } else {
                        html += `<div class="error">‚ùå '${char}' –Ω–µ –Ω–∞–π–¥–µ–Ω</div>`;
                    }
                });
                
            } catch (error) {
                html += `<div class="error">‚ùå –û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è inspector: ${error.message}</div>`;
            }
            
            testDiv.innerHTML = html;
        }
        
        // –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π —Ç–µ—Å—Ç
        document.getElementById('testChar').addEventListener('input', function(e) {
            const char = e.target.value;
            const resultDiv = document.getElementById('testResult');
            
            if (!char || !window.browserInspector) {
                resultDiv.innerHTML = '';
                return;
            }
            
            const result = window.browserInspector.inspect(char);
            if (result) {
                resultDiv.innerHTML = `
                    <div class="result">
                        <strong>–°–∏–º–≤–æ–ª:</strong> "${result.char}"<br>
                        <strong>–ö–ª–∞–≤–∏—à–∞:</strong> ${result.keyDefinition.code}<br>
                        <strong>–†–∞—Å–∫–ª–∞–¥–∫–∏:</strong> ${Object.entries(result.layouts)
                            .map(([layout, char]) => `${layout.toUpperCase()}=${char || '‚àÖ'}`)
                            .join(', ')}
                    </div>
                `;
            } else {
                resultDiv.innerHTML = `<div class="error">–°–∏–º–≤–æ–ª "${char}" –Ω–µ –Ω–∞–π–¥–µ–Ω</div>`;
            }
        });
        
        // –ó–∞–ø—É—Å–∫–∞–µ–º —Ç–µ—Å—Ç—ã
        testBrowserJS();
    </script>
</body>
</html>

