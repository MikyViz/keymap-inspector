<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ë—ã—Å—Ç—Ä–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ Keymap Inspector</title>
    <style>
        body { 
            font-family: Arial, sans-serif; 
            max-width: 800px; 
            margin: 50px auto; 
            padding: 20px; 
            background: #f0f8ff;
        }
        .test-box { 
            background: white; 
            padding: 30px; 
            border-radius: 10px; 
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }
        input { 
            padding: 15px; 
            font-size: 20px; 
            border: 2px solid #4CAF50; 
            border-radius: 8px; 
            width: 100px; 
            text-align: center;
            margin: 5px;
        }
        .result { 
            background: #e8f5e8; 
            padding: 15px; 
            border-radius: 8px; 
            margin: 15px 0; 
            border-left: 4px solid #4CAF50;
        }
        .error { 
            background: #ffe8e8; 
            border-left-color: #f44336; 
        }
        .layout-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(80px, 1fr));
            gap: 10px;
            margin: 10px 0;
        }
        .layout-item {
            background: #2196F3;
            color: white;
            padding: 8px;
            border-radius: 5px;
            text-align: center;
            font-weight: bold;
        }
        .status { 
            padding: 10px; 
            border-radius: 5px; 
            margin: 5px 0; 
            font-weight: bold;
        }
        .success { background: #d4edda; color: #155724; }
        .warning { background: #fff3cd; color: #856404; }
        .info { background: #d1ecf1; color: #0c5460; }
    </style>
</head>
<body>
    <div class="test-box">
        <h1>üöÄ –ë—ã—Å—Ç—Ä–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ Keymap Inspector</h1>
        
        <div id="loadStatus"></div>
        
        <h3>–í–≤–µ–¥–∏—Ç–µ —Å–∏–º–≤–æ–ª—ã –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏:</h3>
        <div>
            <input type="text" maxlength="1" placeholder="a" id="test1">
            <input type="text" maxlength="1" placeholder="–π" id="test2">
            <input type="text" maxlength="1" placeholder="√§" id="test3">
            <input type="text" maxlength="1" placeholder="√©" id="test4">
            <input type="text" maxlength="1" placeholder="√±" id="test5">
        </div>
        
        <div id="results"></div>
        
        <h3>üéØ –ü—Ä–µ–¥—É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã:</h3>
        <div id="presetTests"></div>
    </div>

    <!-- –ü–æ–¥–∫–ª—é—á–∞–µ–º Keymap Inspector -->
    <script src="../dist/keymap-inspector.umd.js"></script>
    
    <script>
        // –ü—Ä–æ–≤–µ—Ä—è–µ–º –∑–∞–≥—Ä—É–∑–∫—É
        function checkLoading() {
            const statusDiv = document.getElementById('loadStatus');
            let html = '';
            
            if (typeof KeymapInspector === 'undefined') {
                html = '<div class="status warning">‚ö†Ô∏è KeymapInspector –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω</div>';
            } else {
                html = '<div class="status success">‚úÖ KeymapInspector –∑–∞–≥—Ä—É–∂–µ–Ω</div>';
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ä–∞—Å–∫–ª–∞–¥–∫–∏
                const layouts = ['en', 'ru', 'de', 'fr', 'es', 'ua', 'he'];
                const available = [];
                
                layouts.forEach(layout => {
                    if (KeymapInspector[layout]) {
                        available.push(layout.toUpperCase());
                    }
                });
                
                html += `<div class="status info">üìö –î–æ—Å—Ç—É–ø–Ω—ã–µ —Ä–∞—Å–∫–ª–∞–¥–∫–∏: ${available.join(', ')}</div>`;
                
                // –°–æ–∑–¥–∞—ë–º inspector
                try {
                    window.inspector = new KeymapInspector.KeymapInspector({
                        en: KeymapInspector.en,
                        ru: KeymapInspector.ru,
                        de: KeymapInspector.de,
                        fr: KeymapInspector.fr,
                        es: KeymapInspector.es,
                        ua: KeymapInspector.ua,
                        he: KeymapInspector.he
                    });
                    html += '<div class="status success">‚úÖ Inspector —Å–æ–∑–¥–∞–Ω —É—Å–ø–µ—à–Ω–æ</div>';
                    
                    runPresetTests();
                } catch (error) {
                    html += `<div class="status warning">‚ö†Ô∏è –û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è inspector: ${error.message}</div>`;
                }
            }
            
            statusDiv.innerHTML = html;
        }
        
        // –ü—Ä–µ–¥—É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã
        function runPresetTests() {
            const testChars = [
                { char: 'a', desc: '–ê–Ω–≥–ª–∏–π—Å–∫–∞—è "a"' },
                { char: '–π', desc: '–†—É—Å—Å–∫–∞—è "–π"' },
                { char: '√§', desc: '–ù–µ–º–µ—Ü–∫–∞—è "√§"' },
                { char: '√©', desc: '–§—Ä–∞–Ω—Ü—É–∑—Å–∫–∞—è "√©"' },
                { char: '√±', desc: '–ò—Å–ø–∞–Ω—Å–∫–∞—è "√±"' },
                { char: '—ñ', desc: '–£–∫—Ä–∞–∏–Ω—Å–∫–∞—è "—ñ"' },
                { char: '◊©', desc: '–ï–≤—Ä–µ–π—Å–∫–∞—è "◊©"' }
            ];
            
            let html = '';
            
            testChars.forEach(test => {
                const result = window.inspector.inspect(test.char);
                if (result) {
                    html += `
                        <div class="result">
                            <strong>${test.desc}:</strong> "${result.char}" ‚Üí –ö–ª–∞–≤–∏—à–∞: ${result.keyDefinition.code}
                            <div class="layout-grid">
                    `;
                    
                    for (const layout in result.layouts) {
                        const char = result.layouts[layout] || '‚àÖ';
                        html += `<div class="layout-item">${layout.toUpperCase()}: ${char}</div>`;
                    }
                    
                    html += '</div></div>';
                } else {
                    html += `<div class="result error">‚ùå ${test.desc}: "${test.char}" –Ω–µ –Ω–∞–π–¥–µ–Ω</div>`;
                }
            });
            
            document.getElementById('presetTests').innerHTML = html;
        }
        
        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è input –ø–æ–ª–µ–π
        function setupInputHandlers() {
            for (let i = 1; i <= 5; i++) {
                const input = document.getElementById(`test${i}`);
                input.addEventListener('input', function(e) {
                    const char = e.target.value;
                    if (!char || !window.inspector) return;
                    
                    const result = window.inspector.inspect(char);
                    updateResults(result, char);
                });
            }
        }
        
        function updateResults(result, char) {
            const resultsDiv = document.getElementById('results');
            
            if (result) {
                let html = `
                    <div class="result">
                        <strong>–°–∏–º–≤–æ–ª:</strong> "${result.char}" ‚Üí <strong>–ö–ª–∞–≤–∏—à–∞:</strong> ${result.keyDefinition.code}
                        <div class="layout-grid">
                `;
                
                for (const layout in result.layouts) {
                    const layoutChar = result.layouts[layout] || '‚àÖ';
                    html += `<div class="layout-item">${layout.toUpperCase()}: ${layoutChar}</div>`;
                }
                
                html += '</div></div>';
                resultsDiv.innerHTML = html;
            } else {
                resultsDiv.innerHTML = `<div class="result error">‚ùå –°–∏–º–≤–æ–ª "${char}" –Ω–µ –Ω–∞–π–¥–µ–Ω –≤ —Ä–∞—Å–∫–ª–∞–¥–∫–∞—Ö</div>`;
            }
        }
        
        // –ó–∞–ø—É—Å–∫–∞–µ–º –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        window.addEventListener('load', function() {
            checkLoading();
            setupInputHandlers();
        });
    </script>
</body>
</html>

