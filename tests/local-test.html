<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–¢–µ—Å—Ç –ª–æ–∫–∞–ª—å–Ω—ã—Ö –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; background: #f5f5f5; }
        .container { background: white; padding: 20px; border-radius: 8px; margin: 10px 0; }
        .success { color: #28a745; background: #d4edda; padding: 10px; border-radius: 4px; margin: 5px 0; }
        .error { color: #dc3545; background: #f8d7da; padding: 10px; border-radius: 4px; margin: 5px 0; }
        .info { color: #0c5460; background: #d1ecf1; padding: 10px; border-radius: 4px; margin: 5px 0; }
        pre { background: #f8f9fa; padding: 10px; border-radius: 4px; overflow-x: auto; font-size: 12px; }
        input { padding: 8px; font-size: 14px; border: 2px solid #ddd; border-radius: 4px; width: 200px; }
        .result { background: #e8f5e8; padding: 10px; margin: 10px 0; border-radius: 4px; border-left: 4px solid #28a745; }
    </style>
</head>
<body>
    <h1>üîß –¢–µ—Å—Ç –ª–æ–∫–∞–ª—å–Ω—ã—Ö –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π keymap-inspector</h1>
    
    <div class="container">
        <h2>1. –¢–µ—Å—Ç browser.js (–ª–æ–∫–∞–ª—å–Ω—ã–π)</h2>
        <div id="browserTest"></div>
    </div>
    
    <div class="container">
        <h2>2. –¢–µ—Å—Ç UMD.js (–ª–æ–∫–∞–ª—å–Ω—ã–π)</h2>
        <div id="umdTest"></div>
    </div>
    
    <div class="container">
        <h2>3. –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π —Ç–µ—Å—Ç</h2>
        <input type="text" id="testInput" placeholder="–í–≤–µ–¥–∏—Ç–µ —Å–∏–º–≤–æ–ª –¥–ª—è —Ç–µ—Å—Ç–∞..." maxlength="1">
        <div id="interactiveResult"></div>
    </div>

    <!-- –¢–µ—Å—Ç–∏—Ä—É–µ–º –ª–æ–∫–∞–ª—å–Ω—É—é browser.js –≤–µ—Ä—Å–∏—é -->
    <script src="../dist/keymap-inspector.browser.js"></script>
    
    <script>
        window.LocalBrowserKeymap = window.KeymapInspector || KeymapInspector;
        
        function testLocalBrowser() {
            const div = document.getElementById('browserTest');
            let html = '';
            
            html += `<div class="info"><strong>–ò—Å—Ç–æ—á–Ω–∏–∫:</strong> –õ–æ–∫–∞–ª—å–Ω—ã–π ../dist/keymap-inspector.browser.js</div>`;
            html += `<div class="info"><strong>–¢–∏–ø:</strong> ${typeof LocalBrowserKeymap}</div>`;
            
            if (typeof LocalBrowserKeymap === 'function') {
                html += `<div class="info"><strong>–°–≤–æ–π—Å—Ç–≤–∞:</strong> ${Object.getOwnPropertyNames(LocalBrowserKeymap).join(', ')}</div>`;
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ä–∞—Å–∫–ª–∞–¥–∫–∏
                const layouts = ['en', 'ru', 'de', 'fr', 'es', 'ua', 'he'];
                let allLayoutsWork = true;
                
                layouts.forEach(layout => {
                    const exists = LocalBrowserKeymap[layout] !== undefined;
                    const count = exists ? Object.keys(LocalBrowserKeymap[layout] || {}).length : 0;
                    
                    if (!exists) allLayoutsWork = false;
                    
                    html += `<div class="${exists ? 'success' : 'error'}">
                        ${exists ? '‚úÖ' : '‚ùå'} ${layout.toUpperCase()}: ${exists ? `${count} —Å–∏–º–≤–æ–ª–æ–≤` : 'undefined'}
                    </div>`;
                });
                
                if (allLayoutsWork) {
                    html += `<div class="success">üéâ –í—Å–µ —Ä–∞—Å–∫–ª–∞–¥–∫–∏ –∑–∞–≥—Ä—É–∂–µ–Ω—ã —É—Å–ø–µ—à–Ω–æ!</div>`;
                    
                    // –¢–µ—Å—Ç–∏—Ä—É–µ–º —Å–æ–∑–¥–∞–Ω–∏–µ inspector
                    try {
                        const inspector = new LocalBrowserKeymap({
                            en: LocalBrowserKeymap.en,
                            ru: LocalBrowserKeymap.ru,
                            de: LocalBrowserKeymap.de,
                            fr: LocalBrowserKeymap.fr,
                            es: LocalBrowserKeymap.es,
                            ua: LocalBrowserKeymap.ua,
                            he: LocalBrowserKeymap.he
                        });
                        
                        // –¢–µ—Å—Ç–∏—Ä—É–µ–º —Ä–∞–∑–Ω—ã–µ —Å–∏–º–≤–æ–ª—ã
                        const testChars = ['a', '–π', '√§', '√©', '√±'];
                        let allTestsPass = true;
                        
                        testChars.forEach(char => {
                            const result = inspector.inspect(char);
                            if (result) {
                                html += `<div class="success">‚úÖ '${char}' ‚Üí Key: ${result.keyDefinition.code}</div>`;
                            } else {
                                html += `<div class="error">‚ùå '${char}' ‚Üí –Ω–µ –Ω–∞–π–¥–µ–Ω</div>`;
                                allTestsPass = false;
                            }
                        });
                        
                        if (allTestsPass) {
                            html += `<div class="success">üöÄ Browser.js –≤–µ—Ä—Å–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç –∏–¥–µ–∞–ª—å–Ω–æ!</div>`;
                            window.workingLocalInspector = inspector;
                        }
                        
                    } catch (error) {
                        html += `<div class="error">‚ùå –û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è inspector: ${error.message}</div>`;
                    }
                } else {
                    html += `<div class="error">‚ùå –ù–µ –≤—Å–µ —Ä–∞—Å–∫–ª–∞–¥–∫–∏ –∑–∞–≥—Ä—É–∂–µ–Ω—ã</div>`;
                }
            }
            
            div.innerHTML = html;
        }
        
        testLocalBrowser();
    </script>
    
    <!-- –û—á–∏—â–∞–µ–º –∏ —Ç–µ—Å—Ç–∏—Ä—É–µ–º UMD -->
    <script>
        window.KeymapInspector = undefined;
        delete window.KeymapInspector;
    </script>
    <script src="../dist/keymap-inspector.umd.js"></script>
    
    <script>
        function testLocalUMD() {
            const div = document.getElementById('umdTest');
            let html = '';
            
            html += `<div class="info"><strong>–ò—Å—Ç–æ—á–Ω–∏–∫:</strong> –õ–æ–∫–∞–ª—å–Ω—ã–π ../dist/keymap-inspector.umd.js</div>`;
            html += `<div class="info"><strong>–¢–∏–ø:</strong> ${typeof KeymapInspector}</div>`;
            
            if (typeof KeymapInspector === 'object') {
                html += `<div class="info"><strong>–°–≤–æ–π—Å—Ç–≤–∞:</strong> ${Object.keys(KeymapInspector).join(', ')}</div>`;
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ä–∞—Å–∫–ª–∞–¥–∫–∏ –∏ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä
                const items = ['KeymapInspector', 'en', 'ru', 'de', 'fr', 'es', 'ua', 'he'];
                let hasConstructor = false;
                let allLayoutsExist = true;
                
                items.forEach(item => {
                    const exists = KeymapInspector[item] !== undefined;
                    
                    if (item === 'KeymapInspector') {
                        hasConstructor = exists;
                        html += `<div class="${exists ? 'success' : 'error'}">
                            ${exists ? '‚úÖ' : '‚ùå'} ${item}: ${exists ? 'constructor function' : 'undefined'}
                        </div>`;
                    } else {
                        if (!exists) allLayoutsExist = false;
                        const count = exists ? Object.keys(KeymapInspector[item] || {}).length : 0;
                        html += `<div class="${exists ? 'success' : 'error'}">
                            ${exists ? '‚úÖ' : '‚ùå'} ${item.toUpperCase()}: ${exists ? `${count} —Å–∏–º–≤–æ–ª–æ–≤` : 'undefined'}
                        </div>`;
                    }
                });
                
                if (hasConstructor && allLayoutsExist) {
                    html += `<div class="success">üéâ UMD –≤–µ—Ä—Å–∏—è –∏–º–µ–µ—Ç –≤—Å–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã!</div>`;
                    
                    // –¢–µ—Å—Ç–∏—Ä—É–µ–º —Å–æ–∑–¥–∞–Ω–∏–µ inspector
                    try {
                        const inspector = new KeymapInspector.KeymapInspector({
                            en: KeymapInspector.en,
                            ru: KeymapInspector.ru,
                            de: KeymapInspector.de
                        });
                        
                        const testResult = inspector.inspect('a');
                        if (testResult) {
                            html += `<div class="success">üöÄ UMD Inspector —Ä–∞–±–æ—Ç–∞–µ—Ç! –¢–µ—Å—Ç 'a': ${testResult.keyDefinition.code}</div>`;
                        } else {
                            html += `<div class="error">‚ùå UMD Inspector —Å–æ–∑–¥–∞–ª—Å—è, –Ω–æ inspect –≤–µ—Ä–Ω—É–ª null</div>`;
                        }
                        
                    } catch (error) {
                        html += `<div class="error">‚ùå –û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è UMD inspector: ${error.message}</div>`;
                    }
                } else {
                    html += `<div class="error">‚ùå UMD –≤–µ—Ä—Å–∏–∏ –Ω–µ —Ö–≤–∞—Ç–∞–µ—Ç –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤</div>`;
                }
            }
            
            div.innerHTML = html;
        }
        
        setTimeout(testLocalUMD, 200);
        
        // –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π —Ç–µ—Å—Ç
        document.getElementById('testInput').addEventListener('input', function(e) {
            const char = e.target.value;
            const resultDiv = document.getElementById('interactiveResult');
            
            if (!char) {
                resultDiv.innerHTML = '';
                return;
            }
            
            if (window.workingLocalInspector) {
                const result = window.workingLocalInspector.inspect(char);
                if (result) {
                    let html = `
                        <div class="result">
                            <strong>–°–∏–º–≤–æ–ª:</strong> "${result.char}" | 
                            <strong>–ö–ª–∞–≤–∏—à–∞:</strong> ${result.keyDefinition.code}<br>
                            <strong>–í–æ –≤—Å–µ—Ö —Ä–∞—Å–∫–ª–∞–¥–∫–∞—Ö:</strong><br>
                    `;
                    
                    for (const [layout, layoutChar] of Object.entries(result.layouts)) {
                        html += `${layout.toUpperCase()}: ${layoutChar || '‚àÖ'} | `;
                    }
                    
                    html += '</div>';
                    resultDiv.innerHTML = html;
                } else {
                    resultDiv.innerHTML = `<div class="error">–°–∏–º–≤–æ–ª "${char}" –Ω–µ –Ω–∞–π–¥–µ–Ω</div>`;
                }
            } else {
                resultDiv.innerHTML = `<div class="error">Inspector –Ω–µ –≥–æ—Ç–æ–≤</div>`;
            }
        });
    </script>
</body>
</html>

